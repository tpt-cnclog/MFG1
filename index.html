<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    // Dynamic base href detection - MUST run before any resources load
    (function() {
      const hostname = window.location.hostname;
      const pathname = window.location.pathname;
      
      console.log('Detecting environment...');
      console.log('Hostname:', hostname);
      console.log('Pathname:', pathname);
      console.log('Full URL:', window.location.href);
      
      let baseHref = './'; // Default
      
      if (hostname === 'tpt-cnclog.github.io') {
        // Original GitHub Pages
        baseHref = '/cnc-webapp/';
        console.log('Environment: GitHub Pages (Original)');
      } else if (hostname === 'gunnapatttt.github.io') {
        // Your GitHub Pages
        baseHref = '/cnc-webapp-local/';
        console.log('Environment: GitHub Pages (Your Repository)');
      } else if (hostname === 'localhost' || hostname === '127.0.0.1' || hostname === '') {
        // Local development
        if (pathname.endsWith('/index.html')) {
          // Accessing index.html directly - use the directory part
          baseHref = pathname.substring(0, pathname.lastIndexOf('/') + 1);
          console.log('Environment: Local Development (direct file access)');
        } else if (pathname.endsWith('/')) {
          // Accessing directory - use relative paths
          baseHref = './';
          console.log('Environment: Local Development (directory access)');
        } else {
          // Default to current directory
          baseHref = './';
          console.log('Environment: Local Development (default)');
        }
      }
      
      console.log('Base href will be set to:', baseHref);
      
      // Write the base tag immediately
      document.write('<base href="' + baseHref + '">');
    })();
  </script>
  <title>TPT-CNC JOB LOG</title>
  <link rel="icon" type="image/png" href="JOBLOG LOGO.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1976d2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="CNC Log">
  <script>
    // Simple PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('./sw.js')
          .then(function(registration) {
            console.log('SW registered: ', registration);
          })
          .catch(function(registrationError) {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
  </script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <script src="scripts/config.js"></script>
  <script src="scripts/api-service.js"></script>
  <script src="scripts/qr-scanner.js"></script>
  <script src="scripts/data-validators.js"></script>
  <script src="scripts/form-handlers.js"></script>
  <script src="scripts/ui-manager.js"></script>
  <script src="scripts/app.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sarabun:400,700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/components.css">
  <link rel="stylesheet" href="styles/responsive.css">
</head>
<body>
<main>
<!-- Scan Screen -->
<div id="scan-screen" class="scan-screen-container">
  <div class="branding-icon branding-container">
    <img alt="Company Logo" src="logo2024-Black.png" class="logo-image">
  </div>
  <h1 class="page-title">CNC JOB LOG</h1>
  <div class="qr-bounding-box qr-container">
    <div class="instruction-container">
      <span class="instruction-box"><span>แสกน QR Code ตรงนี้</span></span>
    </div>
    <div class="active" id="qr-reader"></div>
    <div class="manual-input-button-container">
      <button onclick="toggleManualInput()" class="manual-input-toggle-btn">
        <i class="fas fa-keyboard" style="font-size: 1.1em;"></i>
        <span>ไม่สามารถใช้กล้องได้? ใส่ข้อมูลด้วยตนเอง</span>
      </button>
    </div>
<div id="manual-input" style="
  display: none; 
  width: 100%; 
  max-width: 450px; 
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); 
  border-radius: 16px; 
  padding: 24px; 
  margin: 15px 0;
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  border: 2px solid #e3f2fd;
">
<h3 style="
  margin: 0 0 20px 0; 
  text-align: center; 
  color: #1976d2;
  font-size: 1.3rem;
  font-weight: 700;
">
<i class="fas fa-edit" style="margin-right: 8px;"></i>ใส่ข้อมูล QR Code
</h3>
<form onsubmit="processManualInput(event)">
<label style="display: block; margin: 12px 0 6px 0; color: #333; font-weight: 600;">Project Number:</label>
<input type="text" id="manual-project" required style="
  width: 100%; 
  padding: 12px; 
  border: 2px solid #e1e5e9; 
  border-radius: 8px; 
  margin-bottom: 12px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
  box-sizing: border-box;
" onfocus="this.style.borderColor='#1976d2'" onblur="this.style.borderColor='#e1e5e9'">
<label style="display: block; margin: 12px 0 6px 0; color: #333; font-weight: 600;">Customer Name:</label>
<input type="text" id="manual-customer" required style="
  width: 100%; 
  padding: 12px; 
  border: 2px solid #e1e5e9; 
  border-radius: 8px; 
  margin-bottom: 12px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
  box-sizing: border-box;
" onfocus="this.style.borderColor='#1976d2'" onblur="this.style.borderColor='#e1e5e9'">
<label style="display: block; margin: 12px 0 6px 0; color: #333; font-weight: 600;">Part Name:</label>
<input type="text" id="manual-part" required style="
  width: 100%; 
  padding: 12px; 
  border: 2px solid #e1e5e9; 
  border-radius: 8px; 
  margin-bottom: 12px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
  box-sizing: border-box;
" onfocus="this.style.borderColor='#1976d2'" onblur="this.style.borderColor='#e1e5e9'">
<label style="display: block; margin: 12px 0 6px 0; color: #333; font-weight: 600;">Drawing Number:</label>
<input type="text" id="manual-drawing" required style="
  width: 100%; 
  padding: 12px; 
  border: 2px solid #e1e5e9; 
  border-radius: 8px; 
  margin-bottom: 12px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
  box-sizing: border-box;
" onfocus="this.style.borderColor='#1976d2'" onblur="this.style.borderColor='#e1e5e9'">
<label style="display: block; margin: 12px 0 6px 0; color: #333; font-weight: 600;">Quantity Ordered:</label>
<input type="number" id="manual-quantity" required style="
  width: 100%; 
  padding: 12px; 
  border: 2px solid #e1e5e9; 
  border-radius: 8px; 
  margin-bottom: 20px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
  box-sizing: border-box;
" onfocus="this.style.borderColor='#1976d2'" onblur="this.style.borderColor='#e1e5e9'">
<div style="text-align: center;">
<button type="submit" style="
  background: linear-gradient(90deg, #4caf50 0%, #388e3c 100%); 
  color: white; 
  border: none; 
  border-radius: 8px; 
  padding: 12px 24px; 
  margin-right: 10px; 
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  box-shadow: 0 3px 8px rgba(76, 175, 80, 0.3);
  transition: all 0.2s ease;
" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
<i class="fas fa-check" style="margin-right: 6px;"></i>ยืนยัน
</button>
<button type="button" onclick="toggleManualInput()" style="
  background: linear-gradient(90deg, #757575 0%, #424242 100%); 
  color: white; 
  border: none; 
  border-radius: 8px; 
  padding: 12px 24px; 
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  box-shadow: 0 3px 8px rgba(117, 117, 117, 0.3);
  transition: all 0.2s ease;
" onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
<i class="fas fa-times" style="margin-right: 6px;"></i>ยกเลิก
</button>
</div>
</form>
</div>
</div>
</div>
<!-- Job Info Screen -->
<div id="info-screen" style="display:none;">
<button class="btn-back" onclick="resetAll()" style="margin-top:25px; margin-bottom:30px; margin-left: 20px;">← <span style="font-size:1em; vertical-align:middle;">แสกน QR Code</span></button>
<div class="main-bounding-box" style="border:2px solid #e0e0e0; border-radius:24px; padding:18px 0 32px 0; margin-bottom:24px; margin-left: 5px; margin-right: 5px; background:#ececec;">
<h1>CNC JOB LOG</h1>
<div class="job-info" id="job-info"></div>
<div class="btn-row">
<button class="btn-green main-btn" onclick="showScreen('start-form')">
<i class="fas fa-play" style="font-size:1.3em;"></i>
<span>เริ่มงานใหม่</span>
</button>
<button class="btn-red main-btn" onclick="fetchOpenJobsAndShowStopSelector()">
<i class="fas fa-stop" style="font-size:1.3em;"></i>
<span>งานเสร็จสิ้น</span>
</button>
</div> 
<!-- Daily Report and QC Report Buttons -->
<div class="btn-row secondary-btn-row first-row" style="margin-bottom: 10px;">
<button class="btn-secondary daily-report secondary-btn" onclick="showDailyReportModal()" style="font-size:1rem; display:flex; align-items:center; justify-content:center; gap:8px; background:#4CAF50; color:#ffffff;">
<i class="fas fa-chart-bar" style="font-size:1.3em;"></i>
<span>รายงานประจำวัน</span>
</button>
<button class="btn-secondary qc-report secondary-btn" onclick="showQCReportModal()" style="font-size:1rem; display:flex; align-items:center; justify-content:center; gap:8px; background:#9C27B0; color:#ffffff;">
<i class="fas fa-clipboard-check" style="font-size:1.3em;"></i>
<span>QC Report</span>
</button>
</div>
<div class="btn-row secondary-btn-row">
<button class="btn-secondary pause secondary-btn" onclick="fetchOpenJobsAndShowPauseSelector()">
<i class="fas fa-pause" style="font-size:1.3em;"></i>
<span>หยุดชั่วคราว/Downtime</span>
</button>
<button class="btn-secondary continue secondary-btn" onclick="fetchPausedJobsAndShowContinueSelector()">
<i class="fas fa-forward" style="font-size:1.3em;"></i>
<span>ดำเนินการต่อ</span>
</button>
</div>
<div class="btn-row secondary-btn-row">
<button class="btn-secondary btn-machine-setting secondary-btn" id="machine-setting-btn" onclick="document.getElementById('machine-setting-modal').style.display = 'flex';" style="font-size:1rem; display:flex; align-items:center; justify-content:center; gap:8px;">
<i class="fas fa-cogs" style="font-size:1.3em;"></i>
<span>Machine Setting</span>
</button>
</button>
<button class="btn-secondary btn-ot secondary-btn" id="ot-btn" onclick="checkOTStartTime()" style="font-size:1rem; display:flex; align-items:center; justify-content:center; gap:8px; background:#42a5f5; color:#ffffff;">
<i class="fas fa-clock" style="font-size:1.3em;"></i>
<span>OT</span>
</button>
</div>
</div>
</div>
<!-- Start Form Screen -->
<form class="form-section" id="start-form" onsubmit="submitStart(event)" style="display:none;">
<button class="btn-back" onclick="showScreen('info-screen')" type="button">← กลับไปก่อนหน้า</button>
<h2>เริ่มงาน</h2>
<div class="job-info" id="start-job-info"></div>
<label>Process Name:</label>
<select name="processName" required="">
<option value="">เลือก</option>
<option>CL</option><option>MC</option><option>GR</option><option>WC</option><option>ML</option>
<option>BL</option><option>CRP</option><option>MRP</option><option>NC</option><option>QC</option><option>Rework</option><option> Machine Setting</option>
</select>
<label>Process No.:</label>
<input inputmode="numeric" max="20" min="1" name="processNo" required="" type="number"/>
<label>Step No.:</label>
<input name="stepNo" onblur="validateStepNo(this)" pattern="^[0-9]+(\+[0-9]+)*$" placeholder="เช่น: 1 หรือ 1+2+3" required="" type="text"/>
<label>Machine No.:</label>
<input name="machineNo" oninput="this.value = this.value.toUpperCase()" placeholder="เช่น: MC01" required="" style="text-transform: uppercase;"/>
<label>รหัสพนักงาน:</label>
<input name="employeeCode" oninput="this.value = this.value.toUpperCase()" placeholder="เช่น: A0001" required="" style="text-transform: uppercase;"/>
<button type="submit">กดเพื่อส่ง</button>
</form>
<!-- Stop Form Screen -->
<form class="form-section" id="stop-form" onsubmit="submitStop(event)" style="display:none;">
<button class="btn-back" onclick="showScreen('info-screen')" type="button">← กลับไปก่อนหน้า</button>
<h2>งานเสร็จสิ้น</h2>
<div class="job-info" id="stop-job-info"> </div> 
<label>รหัสพนักงาน:</label>
<input name="employeeCode" oninput="this.value = this.value.toUpperCase()" placeholder="เช่น: A0001" required="" style="text-transform: uppercase;"/>
<div class="stop-extra-field" id="fg-row">
<label>FG จำนวน:</label>
<input inputmode="numeric" name="fg" required="" type="number"/>
</div>
<div class="stop-extra-field" id="ng-row">
<label>NG จำนวน:</label>
<input inputmode="numeric" name="ng" required="" type="number"/>
</div>
<div class="stop-extra-field" id="rework-row">
<label>Rework จำนวน:</label>
<input inputmode="numeric" name="rework" required="" type="number"/>
</div>
<button type="submit">กดเพื่อส่ง</button>
</form>
<!-- Confirmation Screen -->
<div class="confirm-section" id="confirm-screen" style="display:none;">
<h2>ข้อมูลถูกส่งเข้าสู่ระบบเรียบร้อยแล้ว</h2>
<button onclick="resetAll()">กลับไปหน้าแสกน QR Code</button>
</div>
<!-- Loading Screen -->
<div class="confirm-section" id="loading-screen" style="display:none;">
<div aria-label="กำลังโหลด" class="loader-spinner" role="status"></div>
<h2 style="margin-top:32px;">กำลังส่งข้อมูล...</h2>
</div>
<!-- Pause/Downtime Reason Modal -->
<div id="pause-reason-modal" style="display:none;">
<div class="pause-reason-modal-content">
<h2 style="text-align:center;">เลือกเหตุผลการหยุดงาน</h2>
<form id="pause-reason-form">
<div style="margin-bottom:18px;">
<label>เลือกเหตุผลการหยุดงาน:</label>
<select name="pauseReasonSelect" required style="width:100%; padding:8px; border-radius:8px; border:1.5px solid #90caf9; margin-top:6px;">
<option value="">-- เลือกเหตุผล --</option>
<option>รองาน</option>
<option>ทิ้งเศษ</option>
<option>Wait for Data inspection</option>
<option>Change Tool</option>
<option>Over Spec</option>
<option>Machine Error</option>
<option>Program Error</option>
<option>ไฟดับ</option>
<option>ลมตก</option>
<option value="อื่นๆ โปรดระบุ">อื่นๆ โปรดระบุ</option>
</select>
</div>
<div id="pause-other-reason" style="display:none; margin-bottom:18px;">
<label>โปรดระบุเหตุผล:</label>
<input maxlength="100" name="pauseOtherReason" style="width:100%; padding:8px; border-radius:8px; border:1.5px solid #90caf9; margin-top:6px;" type="text"/>
</div>
<div style="text-align:center;">
<button style="padding:10px 32px; border-radius:10px; background:#1976d2; color:#fff; border:none; font-size:1.1rem; cursor:pointer;" type="submit">ส่งข้อมูล</button>
<button onclick="closePauseReasonModal()" style="padding:10px 24px; border-radius:10px; background:#aaa; color:#fff; border:none; font-size:1.1rem; cursor:pointer; margin-left:10px;" type="button">ยกเลิก</button>
</div>
</form>
</div>
</div>
</main>
<!-- Machine Setting Modal -->
<div id="machine-setting-modal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(255,255,255,0.85); z-index:3000; align-items:center; justify-content:center;">
<div style="background:#fff; border-radius:18px; padding:32px 24px; max-width:340px; width:100%; margin:0 auto; box-shadow:0 2px 24px #0005; text-align:center;">
<h2>Machine Setting</h2>
<p>เลือกประเภทการทำงาน</p>
<button id="machine-setting-start-btn" style="padding:10px 32px; border-radius:10px; background:#1976d2; color:#fff; border:none; font-size:1.1rem; cursor:pointer; margin:8px;">เริ่ม</button>
<button id="machine-setting-stop-btn" style="padding:10px 32px; border-radius:10px; background:#b71c1c; color:#fff; border:none; font-size:1.1rem; cursor:pointer; margin:8px;">หยุด</button>
<br/><br/>
<button onclick="closeMachineSettingModal()" style="padding:8px 24px; border-radius:8px; background:#aaa; color:#fff; border:none; cursor:pointer;">ยกเลิก</button>
</div>
</div>
<!-- OT Modal -->
<div id="ot-modal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(255,255,255,0.85); z-index:3000; align-items:center; justify-content:center;">
<div style="background:#fff; border-radius:18px; padding:32px 24px; max-width:340px; width:100%; margin:0 auto; box-shadow:0 2px 24px #0005; text-align:center;">
<h2>OT (Overtime)</h2>
<p>เลือกประเภทการทำงาน OT</p>
<button id="ot-start-btn" style="padding:10px 32px; border-radius:10px; background:#1976d2; color:#fff; border:none; font-size:1.1rem; cursor:pointer; margin:8px;">เริ่ม OT</button>
<button id="ot-stop-btn" style="padding:10px 32px; border-radius:10px; background:#b71c1c; color:#fff; border:none; font-size:1.1rem; cursor:pointer; margin:8px;">หยุด OT</button>
<br/><br/>
<button onclick="closeOTModal()" style="padding:8px 24px; border-radius:8px; background:#aaa; color:#fff; border:none; cursor:pointer;">ยกเลิก</button>
</div>
</div>
<!-- Daily Report Modal -->
<div id="daily-report-modal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:3000; align-items:center; justify-content:center;">
<div style="background:#fff; border-radius:18px; padding:24px; max-width:500px; width:95%; max-height:90vh; overflow-y:auto; margin:0 auto; box-shadow:0 4px 24px rgba(0,0,0,0.2);">
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid #4CAF50; padding-bottom:12px;">
<h2 style="margin:0; color:#2E7D32;">📊 รายงานประจำวัน</h2>
<button onclick="closeDailyReportModal()" style="background:none; border:none; font-size:1.5rem; cursor:pointer; color:#666;">&times;</button>
</div>
<form id="daily-report-form" onsubmit="submitDailyReport(event)">
<!-- Job Information Section -->
<div style="margin-bottom:24px;">
<h3 style="color:#2E7D32; border-bottom:1px solid #4CAF50; padding-bottom:6px; margin-bottom:16px;">ข้อมูลงาน</h3>
<div style="background:#f8f9fa; border-radius:8px; padding:16px;">
<p style="margin:8px 0;"><strong>วันที่:</strong> <span id="daily-report-date-display"></span></p>
<p style="margin:8px 0;"><strong>Project No.:</strong> <span id="daily-report-project-no-display"></span></p>
<p style="margin:8px 0;"><strong>Customer Name:</strong> <span id="daily-report-customer-name-display"></span></p>
<p style="margin:8px 0;"><strong>Part Name:</strong> <span id="daily-report-part-name-display"></span></p>
<p style="margin:8px 0;"><strong>Drawing No.:</strong> <span id="daily-report-drawing-no-display"></span></p>
<p style="margin:8px 0;"><strong>Quantity Ordered:</strong> <span id="daily-report-quantity-ordered-display"></span></p>
<p style="margin:8px 0;"><strong>Process Name:</strong> <span id="daily-report-process-name-display"></span></p>
<p style="margin:8px 0;"><strong>Process No.:</strong> <span id="daily-report-process-no-display"></span></p>
<p style="margin:8px 0;"><strong>Step No.:</strong> <span id="daily-report-step-no-display"></span></p>
<p style="margin:8px 0;"><strong>Machine No.:</strong> <span id="daily-report-machine-no-display"></span></p>
</div>
</div>
<!-- Production Report Section -->
<div style="margin-bottom:24px;">
<h3 style="color:#2E7D32; border-bottom:1px solid #4CAF50; padding-bottom:6px; margin-bottom:16px;">รายงานผลผลิต</h3>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">รหัสพนักงาน *:</label>
<input type="text" name="employeeCode" id="daily-report-employee-code" required placeholder="เช่น A0001" oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '')" style="width:100%; padding:10px; border:2px solid #4CAF50; border-radius:8px; font-size:1rem; text-transform: uppercase;">
</div>
<div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; margin-bottom:16px;">
<div>
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">FG *:</label>
<input type="number" name="fg" id="daily-report-fg" min="0" required placeholder="0" oninput="updateDailyReportTotal()" style="width:100%; padding:10px; border:2px solid #4CAF50; border-radius:8px; font-size:1rem;">
</div>
<div>
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">NG *:</label>
<input type="number" name="ng" id="daily-report-ng" min="0" required placeholder="0" oninput="updateDailyReportTotal()" style="width:100%; padding:10px; border:2px solid #4CAF50; border-radius:8px; font-size:1rem;">
</div>
<div>
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">Rework *:</label>
<input type="number" name="rework" id="daily-report-rework" min="0" required placeholder="0" oninput="updateDailyReportTotal()" style="width:100%; padding:10px; border:2px solid #4CAF50; border-radius:8px; font-size:1rem;">
</div>
</div>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">Remark:</label>
<textarea name="remark" id="daily-report-remark" rows="3" placeholder="หมายเหตุเพิ่มเติม (ถ้ามี)" style="width:100%; padding:10px; border:2px solid #4CAF50; border-radius:8px; font-size:1rem; resize:vertical;"></textarea>
</div>
<div id="daily-report-total" style="background:#E8F5E8; border:2px solid #4CAF50; border-radius:8px; padding:12px; text-align:center; color:#2E7D32; font-weight:bold;">
รวมชิ้นงาน: <span id="daily-report-total-pieces">0</span> ชิ้น
</div>
</div>
<!-- Action Buttons -->
<div style="display:flex; gap:12px; justify-content:center;">
<button type="button" onclick="closeDailyReportModal()" style="padding:12px 24px; border-radius:10px; background:#757575; color:#fff; border:none; font-size:1.1rem; cursor:pointer;">ยกเลิก</button>
<button type="submit" style="padding:12px 24px; border-radius:10px; background:#4CAF50; color:#fff; border:none; font-size:1.1rem; cursor:pointer;">บันทึกรายงาน</button>
</div>
</form>
</div>
</div>
<!-- QC Report Modal -->
<div id="qc-report-modal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:3000; align-items:center; justify-content:center;">
<div style="background:#fff; border-radius:18px; padding:24px; max-width:500px; width:95%; max-height:90vh; overflow-y:auto; margin:0 auto; box-shadow:0 4px 24px rgba(0,0,0,0.2);">
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid #9C27B0; padding-bottom:12px;">
<h2 style="margin:0; color:#7B1FA2;">🔍 QC Report</h2>
<button onclick="closeQCReportModal()" style="background:none; border:none; font-size:1.5rem; cursor:pointer; color:#666;">&times;</button>
</div>
<form id="qc-report-form" onsubmit="submitQCReport(event)">
<!-- Job Information Section -->
<div style="margin-bottom:24px;">
<h3 style="color:#7B1FA2; border-bottom:1px solid #9C27B0; padding-bottom:6px; margin-bottom:16px;">ข้อมูลงาน</h3>
<div style="background:#f3e5f5; border-radius:8px; padding:16px;">
<p style="margin:8px 0;"><strong>วันที่:</strong> <span id="qc-report-date-display"></span></p>
<p style="margin:8px 0;"><strong>Project No.:</strong> <span id="qc-report-project-no-display"></span></p>
<p style="margin:8px 0;"><strong>Customer Name:</strong> <span id="qc-report-customer-name-display"></span></p>
<p style="margin:8px 0;"><strong>Part Name:</strong> <span id="qc-report-part-name-display"></span></p>
<p style="margin:8px 0;"><strong>Drawing No.:</strong> <span id="qc-report-drawing-no-display"></span></p>
<p style="margin:8px 0;"><strong>Quantity Ordered:</strong> <span id="qc-report-quantity-ordered-display"></span></p>
</div>
</div>
<!-- QC Report Section -->
<div style="margin-bottom:24px;">
<h3 style="color:#7B1FA2; border-bottom:1px solid #9C27B0; padding-bottom:6px; margin-bottom:16px;">QC Report</h3>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">รหัสพนักงาน *:</label>
<input type="text" name="employeeCode" id="qc-report-employee-code" required placeholder="เช่น A0001" oninput="this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '')" style="width:100%; padding:10px; border:2px solid #9C27B0; border-radius:8px; font-size:1rem; text-transform: uppercase;">
</div>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">FG จำนวน *:</label>
<input type="number" name="fg" id="qc-report-fg" min="0" required placeholder="0" style="width:100%; padding:10px; border:2px solid #9C27B0; border-radius:8px; font-size:1rem;">
</div>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">NG จำนวน *:</label>
<input type="number" name="ng" id="qc-report-ng" min="0" required placeholder="0" style="width:100%; padding:10px; border:2px solid #9C27B0; border-radius:8px; font-size:1rem;">
</div>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">Rework จำนวน *:</label>
<input type="number" name="rework" id="qc-report-rework" min="0" required placeholder="0" style="width:100%; padding:10px; border:2px solid #9C27B0; border-radius:8px; font-size:1rem;">
</div>
<div style="margin-bottom:16px;">
<label style="display:block; font-weight:600; margin-bottom:4px; color:#333;">Remark:</label>
<textarea name="remark" id="qc-report-remark" rows="3" placeholder="หมายเหตุเพิ่มเติม (ถ้ามี)" style="width:100%; padding:10px; border:2px solid #9C27B0; border-radius:8px; font-size:1rem; resize:vertical;"></textarea>
</div>
</div>
<!-- Action Buttons -->
<div style="display:flex; gap:12px; justify-content:center;">
<button type="button" onclick="closeQCReportModal()" style="padding:12px 24px; border-radius:10px; background:#757575; color:#fff; border:none; font-size:1.1rem; cursor:pointer;">ยกเลิก</button>
<button type="submit" style="padding:12px 24px; border-radius:10px; background:#9C27B0; color:#fff; border:none; font-size:1.1rem; cursor:pointer;">บันทึก QC</button>
</div>
</form>
</div>
</div>
</body>
</html>
